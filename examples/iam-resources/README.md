<!--

        Copyright (c) 2023 Dell, Inc or its subsidiaries.

        This Source Code Form is subject to the terms of the Mozilla Public
        License, v. 2.0. If a copy of the MPL was not distributed with this
        file, You can obtain one at https://mozilla.org/MPL/2.0/.

-->

# Deploy the IAM Resources Module for PowerScale Clusters

The [terraform configuration file](main.tf) has been provided as an example module to deploy the IAM resources which can be used as an input while creating a [PowerScale Cluster](../../docs/POWERSCALE_CLUSTER.md).

## Description

For the complete set of input variables that can be provided, check the [variables.tf](variables.tf) file.

## Deploy Terraform modules

Download the terraform provider and configure the module using:

```shell
terraform init
```

To apply the changes run:

```shell
terraform apply -auto-approve
```

To get the output parameters generated by the module:

```shell
terraform output
```

<details>
<summary>Click to expand sample response</summary>

Response:
```textmate
powerscale_iam_instance_profile_arn = "arn:aws:iam::873989670331:instance-profile/873989670331-powerscale-node-runtime-instance-profile"
powerscale_iam_instance_profile_name = "873989670331-powerscale-node-runtime-instance-profile"
powerscale_iam_policy_arn = "arn:aws:iam::873989670331:policy/873989670331-powerscale-node-runtime-policy"
powerscale_iam_role_arn = "arn:aws:iam::873989670331:role/873989670331-powerscale-node-runtime-role"
powerscale_iam_role_name = "873989670331-powerscale-node-runtime-role"
```
</details>

The same IAM instance profile can be used for multiple PowerScale Clusters. As long as the Powerscale Clusters are created in one of regions as specified in the list provided as the input parameter `regions`, the same IAM instance profile can be used for all those clusters.
