<!--

        Copyright (c) 2023 Dell, Inc or its subsidiaries.

        This Source Code Form is subject to the terms of the Mozilla Public
        License, v. 2.0. If a copy of the MPL was not distributed with this
        file, You can obtain one at https://mozilla.org/MPL/2.0/.

-->
# Deploy the External Security Group Module for a PowerScale Cluster

The [terraform configuration file](main.tf) has been provided as an example module to deploy the external security group which can be used as an input while creating a PowerScale cluster.

## Description

For the complete set of input variables that can be provided, check the [variables.tf](variables.tf) file.

For the minimal set of input parameters that needs to be passed to this Terraform module create the `terraform.tfvars.json` file and provide the following required input variables in that file: 

```json
{
    "vpc_id": "vpc-#################",
    "external_subnet_id": "subnet-#################"
}

```

> **NOTE**: Kindly ensure that you have a [VPC](https://docs.aws.amazon.com/vpc/latest/userguide/what-is-amazon-vpc.html) and one [subnets](https://docs.aws.amazon.com/vpc/latest/userguide/configure-subnets.html) is created beforehand while deploying this example module which will be used as the external subnet for the [PowerScale Cluster](../../docs/POWERSCALE_CLUSTER.md).

## Deploy Terraform modules

Download the terraform provider and configure the module using:

```shell
terraform init
```

To apply the changes run:

```shell
terraform apply -auto-approve
```

To get the output parameters generated by the module:

```shell
terraform output
```

<details>
<summary>Click to expand sample response</summary>

Response:
```textmate
cluster_id = "in-wahoo"
external_sg_id = "sg-0dce3b089cd09b307"
```
</details>


If you use the security group created in this example, you need to provide the same `cluster_id` as input while deploying the [PowerScale Cluster](../../docs/POWERSCALE_CLUSTER.md) as shown in the `terraform output` of this example module.
